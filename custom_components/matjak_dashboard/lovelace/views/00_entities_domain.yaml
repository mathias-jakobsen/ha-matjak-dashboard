# matjak_dashboard

{% for domain in registry.domains %}
{% set domain_entities_count = registry.entities.get_by_domain(domain)|list|count %}
{% set domain_title = domain.replace("_", " ")|title %}
- title: {{ domain_title }}
  icon: mdi:format-list-bulleted-type
  path: entities_{{ domain }}
  visible: false
  type: custom:grid-layout
  layout:
    grid-gap: var(--grid-gap)
    grid-template-columns: 1fr
    margin: 0
  cards:
    - type: custom:button-card
      view_layout:
        show:
          mediaquery: "(min-width: 960px)"
      template: title
      label: {{ domain_title }}
      state_display: {{ domain_entities_count ~ (" Entity" if domain_entities_count == 1 else " Entities") }}
      variables:
        mj_font_size: 24px
    {% set ns = namespace(entities=[]) %}
    {% for area in registry.areas %}
    {% set entities = registry.entities.get_by_area(area, domain) %}
    {% set ns.entities = ns.entities + entities|map(attribute="entity_id")|list %}
    {% if entities|count > 0 %}
    - type: custom:layout-card
      layout_type: grid
      layout:
        grid-gap: var(--grid-gap)
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr))
        margin: 0
      cards:
        - type: custom:button-card
          view_layout:
            grid-column: 1/-1
          template: title
          label: {{ area.name }}

        {% for entity in entities %}
        - type: custom:button-card
          template: generic_card
          entity: {{ entity.entity_id }}
        {% endfor %}
    {% endif %}
    {% endfor %}

    {% set entities = registry.entities.get_by_domain(domain)|rejectattr("entity_id", "in", ns.entities)|list %}
    {% if entities|count > 0 %}
    - type: custom:layout-card
      layout_type: grid
      layout:
        grid-gap: var(--grid-gap)
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr))
        margin: 0
      cards:
        {% if ns.entities|count > 0 %}
        - type: custom:button-card
          view_layout:
            grid-column: 1/-1
          template: title
          label: No Area
        {% endif %}

        {% for entity in entities %}
        - type: custom:button-card
          template: generic_card
          entity: {{ entity.entity_id }}
        {% endfor %}
    {% endif %}

{% endfor %}

