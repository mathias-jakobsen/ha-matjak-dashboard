generic_card:
  show_icon: true
  show_label: true
  show_name: true
  show_state: true

  variables:
    mj_center_items: false
    mj_is_nested: false
    mj_replace_name_with_label: false
    mj_rows: []
    mj_swap_name_state: false

  styles:
    card:
      - --icon-color: var(--button-card-background-color-off)
      - --margin-row: calc(var(--grid-row-gap) / 2 * -1)
      - background: "[[[ return variables.mj_is_nested ? 'none' : 'var(--ha-card-background)'; ]]]"
      - box-shadow: "[[[ return variables.mj_is_nested ? 'none' : 'var(--ha-card-box-shadow)'; ]]]"
      - padding: var(--ha-card-padding)
      - position: relative
    grid:
      - grid-gap: var(--grid-gap)
      - grid-template: >
          [[[
            let result = variables.mj_swap_name_state ? ["'i s'", "'i n'"] : ["'i n'", "'i s'"];

            if (variables.mj_rows.length > 0) {
              for (const row of variables.mj_rows) {
                result.push(`'${row} ${row}'`);
              }
            }

            return variables.mj_replace_name_with_label ? result.join(" ").replace("n", "l") : result.join(" ");
          ]]]
      - grid-template-columns: >
          [[[
            if (variables.mj_center_items) {
              return "1fr 1fr";
            }

            return "min-content auto";
          ]]]
      - grid-template-rows: min-content min-content
    icon:
      - color: rgba(var(--icon-color), 1)
      - width: 50%
    img_cell:
      - background: rgba(var(--icon-color), 0.2)
      - border-radius: 50%
      - height: 2.8em
      - place-self: "[[[ return variables.mj_center_items ? 'center end' : 'center'; ]]]"
      - width: 2.8em
    label:
      - display: "[[[ return variables.mj_replace_name_with_label ? 'block' : 'none'; ]]]"
      - filter: "[[[ return variables.mj_swap_name_state ? 'opacity(60%)' : 'opacity(100%)'; ]]]"
      - font-size: "[[[ return variables.mj_swap_name_state ? '13px' : '15px'; ]]]"
      - font-weight: "[[[ return variables.mj_swap_name_state ? 'normal' : 'bold'; ]]]"
      - margin: "[[[ return variables.mj_swap_name_state ? 'var(--margin-row) 0 0 0' : '0 0 var(--margin-row) 0'; ]]]"
      - place-self: "[[[ return variables.mj_swap_name_state ? 'start' : 'end start'; ]]]"
    name:
      - display: "[[[ return variables.mj_replace_name_with_label ? 'none' : 'block'; ]]]"
      - filter: "[[[ return variables.mj_swap_name_state ? 'opacity(60%)' : 'opacity(100%)'; ]]]"
      - font-size: "[[[ return variables.mj_swap_name_state ? '13px' : '15px'; ]]]"
      - font-weight: "[[[ return variables.mj_swap_name_state ? 'normal' : 'bold'; ]]]"
      - margin: "[[[ return variables.mj_swap_name_state ? 'var(--margin-row) 0 0 0' : '0 0 var(--margin-row) 0'; ]]]"
      - place-self: "[[[ return variables.mj_swap_name_state ? 'start' : 'end start'; ]]]"
      - text-transform: capitalize
    state:
      - filter: "[[[ return variables.mj_swap_name_state ? 'opacity(100%)' : 'opacity(60%)'; ]]]"
      - font-size: "[[[ return variables.mj_swap_name_state ? '15px' : '13px'; ]]]"
      - font-weight: "[[[ return variables.mj_swap_name_state ? 'bold' : 'normal'; ]]]"
      - margin: "[[[ return variables.mj_swap_name_state ? '0 0 var(--margin-row) 0' : 'var(--margin-row) 0 0 0'; ]]]"
      - place-self: "[[[ return variables.mj_swap_name_state ? 'end start' : 'start'; ]]]"
      - text-transform: capitalize
    custom_fields:
      overlay:
        - background: transparent
        - bottom: 0
        - left: 0
        - position: absolute
        - right: 0
        - top: 0
        - z-index: 1

  custom_fields:
    overlay: ""
    notification_unavailable: >
      [[[
        if (entity?.state == "unavailable") {
          return `<ha-icon icon="mdi:exclamation-thick" style="height: 12px; width: 12px;"></ha-icon>`
        }
      ]]]

  state:
    - id: state_unavailable
      value: "unavailable"
      styles:
        custom_fields:
          notification_unavailable:
            - background: rgba(var(--color-red), 1)
            - border: 2px solid rgba(var(--icon-color), 1)
            - border-radius: 50%
            - color: white
            - height: 16px
            - line-height: 14px
            - left: 41px
            - position: absolute
            - top: 8px
            - width: 16px

    - id: state_on
      operator: template
      value: >
        [[[
          const on_states = ["on", "heat", "auto", "home"];
          return on_states.includes(entity?.state);
        ]]]
      styles:
        card:
          - --icon-color: var(--button-card-background-color-on)
